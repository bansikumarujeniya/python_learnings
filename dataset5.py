cricket_dataset = {
    "player_01": {
        "name": "Virat Kohli",
        "country": "India",
        "role": "Batsman",
        "batting_style": "Right-hand",
        "bowling_style": "Right-arm medium",
        "stats": {
            "matches_played": 300,
            "runs": 13000,
            "wickets": 20,
            "batting_average": 58.67
        }
    },
    "player_02": {
        "name": "Steve Smith",
        "country": "Australia",
        "role": "Batsman",
        "batting_style": "Right-hand",
        "bowling_style": "Right-arm legbreak",
        "stats": {
            "matches_played": 280,
            "runs": 11500,
            "wickets": 45,
            "batting_average": 52.10
        }
    },
    "player_03": {
        "name": "Rashid Khan",
        "country": "Afghanistan",
        "role": "Bowler",
        "batting_style": "Right-hand",
        "bowling_style": "Right-arm legbreak",
        "stats": {
            "matches_played": 150,
            "runs": 1200,
            "wickets": 280,
            "batting_average": 15.45
        }
    },
    "player_04": {
        "name": "Ben Stokes",
        "country": "England",
        "role": "All-rounder",
        "batting_style": "Left-hand",
        "bowling_style": "Right-arm fast-medium",
        "stats": {
            "matches_played": 220,
            "runs": 7500,
            "wickets": 180,
            "batting_average": 38.90
        }
    },
    "player_05": {
        "name": "Kane Williamson",
        "country": "New Zealand",
        "role": "Batsman",
        "batting_style": "Right-hand",
        "bowling_style": "Right-arm offbreak",
        "stats": {
            "matches_played": 250,
            "runs": 9800,
            "wickets": 10,
            "batting_average": 45.23
        }
    },
    "player_06": {
        "name": "Babar Azam",
        "country": "Pakistan",
        "role": "Batsman",
        "batting_style": "Right-hand",
        "bowling_style": "Right-arm offbreak",
        "stats": {
            "matches_played": 210,
            "runs": 8700,
            "wickets": 5,
            "batting_average": 49.88
        }
    },
    "player_07": {
        "name": "Trent Boult",
        "country": "New Zealand",
        "role": "Bowler",
        "batting_style": "Right-hand",
        "bowling_style": "Left-arm fast-medium",
        "stats": {
            "matches_played": 180,
            "runs": 550,
            "wickets": 350,
            "batting_average": 8.50
        }
    },
    "player_08": {
        "name": "Rohit Sharma",
        "country": "India",
        "role": "Batsman",
        "batting_style": "Right-hand",
        "bowling_style": "Right-arm offbreak",
        "stats": {
            "matches_played": 310,
            "runs": 11800,
            "wickets": 8,
            "batting_average": 47.30
        }
    },
    "player_09": {
        "name": "Pat Cummins",
        "country": "Australia",
        "role": "Bowler",
        "batting_style": "Right-hand",
        "bowling_style": "Right-arm fast",
        "stats": {
            "matches_played": 160,
            "runs": 2100,
            "wickets": 310,
            "batting_average": 22.05
        }
    },
    "player_10": {
        "name": "Joe Root",
        "country": "England",
        "role": "Batsman",
        "batting_style": "Right-hand",
        "bowling_style": "Right-arm offbreak",
        "stats": {
            "matches_played": 260,
            "runs": 10500,
            "wickets": 50,
            "batting_average": 48.75
        }
    },
    "player_11": {
        "name": "Jasprit Bumrah",
        "country": "India",
        "role": "Bowler",
        "batting_style": "Right-hand",
        "bowling_style": "Right-arm fast",
        "stats": {
            "matches_played": 140,
            "runs": 150,
            "wickets": 270,
            "batting_average": 6.12
        }
    },
    "player_12": {
        "name": "Quinton de Kock",
        "country": "South Africa",
        "role": "Wicketkeeper-Batsman",
        "batting_style": "Left-hand",
        "bowling_style": "N/A",
        "stats": {
            "matches_played": 240,
            "runs": 8500,
            "wickets": 0,
            "batting_average": 41.28
        }
    },
    "player_13": {
        "name": "Shakib Al Hasan",
        "country": "Bangladesh",
        "role": "All-rounder",
        "batting_style": "Left-hand",
        "bowling_style": "Left-arm orthodox",
        "stats": {
            "matches_played": 320,
            "runs": 7200,
            "wickets": 380,
            "batting_average": 35.50
        }
    },
    "player_14": {
        "name": "Mohammed Rizwan",
        "country": "Pakistan",
        "role": "Wicketkeeper-Batsman",
        "batting_style": "Right-hand",
        "bowling_style": "N/A",
        "stats": {
            "matches_played": 190,
            "runs": 6500,
            "wickets": 0,
            "batting_average": 45.10
        }
    },
    "player_15": {
        "name": "Mitchell Starc",
        "country": "Australia",
        "role": "Bowler",
        "batting_style": "Left-hand",
        "bowling_style": "Left-arm fast",
        "stats": {
            "matches_played": 170,
            "runs": 1100,
            "wickets": 320,
            "batting_average": 18.25
        }
    },
    "player_16": {
        "name": "Josh Hazlewood",
        "country": "Australia",
        "role": "Bowler",
        "batting_style": "Left-hand",
        "bowling_style": "Right-arm fast-medium",
        "stats": {
            "matches_played": 130,
            "runs": 450,
            "wickets": 210,
            "batting_average": 9.80
        }
    },
    "player_17": {
        "name": "David Warner",
        "country": "Australia",
        "role": "Batsman",
        "batting_style": "Left-hand",
        "bowling_style": "Right-arm legbreak",
        "stats": {
            "matches_played": 280,
            "runs": 10900,
            "wickets": 15,
            "batting_average": 45.95
        }
    },
    "player_18": {
        "name": "Jonny Bairstow",
        "country": "England",
        "role": "Wicketkeeper-Batsman",
        "batting_style": "Right-hand",
        "bowling_style": "N/A",
        "stats": {
            "matches_played": 200,
            "runs": 6700,
            "wickets": 0,
            "batting_average": 39.50
        }
    },
    "player_19": {
        "name": "Mohammed Shami",
        "country": "India",
        "role": "Bowler",
        "batting_style": "Right-hand",
        "bowling_style": "Right-arm fast-medium",
        "stats": {
            "matches_played": 120,
            "runs": 380,
            "wickets": 240,
            "batting_average": 12.60
        }
    },
    "player_20": {
        "name": "KL Rahul",
        "country": "India",
        "role": "Batsman",
        "batting_style": "Right-hand",
        "bowling_style": "N/A",
        "stats": {
            "matches_played": 200,
            "runs": 7100,
            "wickets": 0,
            "batting_average": 42.85
        }
    },
    "player_21": {
        "name": "Shubman Gill",
        "country": "India",
        "role": "Batsman",
        "batting_style": "Right-hand",
        "bowling_style": "Right-arm offbreak",
        "stats": {
            "matches_played": 110,
            "runs": 5200,
            "wickets": 3,
            "batting_average": 48.70
        }
    },
    "player_22": {
        "name": "Mitchell Marsh",
        "country": "Australia",
        "role": "All-rounder",
        "batting_style": "Right-hand",
        "bowling_style": "Right-arm fast-medium",
        "stats": {
            "matches_played": 175,
            "runs": 4500,
            "wickets": 100,
            "batting_average": 31.50
        }
    },
    "player_23": {
        "name": "Fakhar Zaman",
        "country": "Pakistan",
        "role": "Batsman",
        "batting_style": "Left-hand",
        "bowling_style": "N/A",
        "stats": {
            "matches_played": 140,
            "runs": 5500,
            "wickets": 0,
            "batting_average": 43.10
        }
    },
    "player_24": {
        "name": "Shaheen Afridi",
        "country": "Pakistan",
        "role": "Bowler",
        "batting_style": "Left-hand",
        "bowling_style": "Left-arm fast",
        "stats": {
            "matches_played": 95,
            "runs": 200,
            "wickets": 190,
            "batting_average": 7.50
        }
    },
    "player_25": {
        "name": "Daryl Mitchell",
        "country": "New Zealand",
        "role": "All-rounder",
        "batting_style": "Right-hand",
        "bowling_style": "Right-arm fast-medium",
        "stats": {
            "matches_played": 120,
            "runs": 3800,
            "wickets": 60,
            "batting_average": 37.80
        }
    },
    "player_26": {
        "name": "Lungi Ngidi",
        "country": "South Africa",
        "role": "Bowler",
        "batting_style": "Right-hand",
        "bowling_style": "Right-arm fast",
        "stats": {
            "matches_played": 80,
            "runs": 120,
            "wickets": 140,
            "batting_average": 6.25
        }
    },
    "player_27": {
        "name": "Jos Buttler",
        "country": "England",
        "role": "Wicketkeeper-Batsman",
        "batting_style": "Right-hand",
        "bowling_style": "N/A",
        "stats": {
            "matches_played": 270,
            "runs": 8900,
            "wickets": 0,
            "batting_average": 41.55
        }
    },
    "player_28": {
        "name": "Hardik Pandya",
        "country": "India",
        "role": "All-rounder",
        "batting_style": "Right-hand",
        "bowling_style": "Right-arm fast-medium",
        "stats": {
            "matches_played": 180,
            "runs": 3500,
            "wickets": 150,
            "batting_average": 29.80
        }
    },
    "player_29": {
        "name": "Glenn Maxwell",
        "country": "Australia",
        "role": "All-rounder",
        "batting_style": "Right-hand",
        "bowling_style": "Right-arm offbreak",
        "stats": {
            "matches_played": 230,
            "runs": 5800,
            "wickets": 120,
            "batting_average": 32.10
        }
    },
    "player_30": {
        "name": "Shai Hope",
        "country": "West Indies",
        "role": "Wicketkeeper-Batsman",
        "batting_style": "Right-hand",
        "bowling_style": "N/A",
        "stats": {
            "matches_played": 160,
            "runs": 6100,
            "wickets": 0,
            "batting_average": 48.95
        }
    }
}

#List
#1. Create a list of the names of all players from Australia.
australian_players = []

for player_id in cricket_dataset:
    player_data = cricket_dataset[player_id]

    if player_data['country'] == 'Australia':
        australian_players.append(player_data['name'])

print(australian_players)


#2. Iterate through the cricket_dataset and create a single list of all the stats dictionaries for all the players.
all_stats = []

for player_id in cricket_dataset:
    stats_dict = cricket_dataset[player_id]['stats']

    all_stats.append(stats_dict)

print(all_stats)

#3. Create a list of the names of all players who are "All-rounder"s and have scored more than 5000 runs.
all_rounders_with_runs = []

for player_id in cricket_dataset:
    player_data = cricket_dataset[player_id]

    if player_data['role'] == 'All-rounder' and player_data['stats']['runs'] > 5000:
        all_rounders_with_runs.append(player_data['name'])

print(all_rounders_with_runs)

#4. Given a list of batting averages, sort the players by their batting average in descending order and return a list of their names.
player_list = list(cricket_dataset.values())
sorted_players = sorted(player_list, key=lambda player: player['stats']['batting_average'], reverse=True)

sorted_player_names = [player['name'] for player in sorted_players]

print(sorted_player_names)

#5. Identify the country with the most "All-rounder" players. Return a list of all the all-rounders from that country.
all_rounder_count = {}
all_rounders_by_country = {}

for player_id, player_info in cricket_dataset.items():
    if player_info['role'] == 'All-rounder':
        country = player_info['country']
        name = player_info['name']

        all_rounder_count[country] = all_rounder_count.get(country, 0) + 1

        if country not in all_rounders_by_country:
            all_rounders_by_country[country] = []
        all_rounders_by_country[country].append(name)

if all_rounder_count:
    country_with_most_all_rounders = max(all_rounder_count, key=all_rounder_count.get)

    all_rounders_list = all_rounders_by_country[country_with_most_all_rounders]

    print(f"The country with the most All-rounder players is: {country_with_most_all_rounders}")
    print(f"The list of all-rounders from that country is: {all_rounders_list}")
else:
    print("No all-rounders found in the dataset.")

#Tuple
#1. Create a tuple containing the name and country of Virat Kohli.
virat_kohli_data = None
for player_id in cricket_dataset:
    if cricket_dataset[player_id]['name'] == 'Virat Kohli':
        virat_kohli_data = cricket_dataset[player_id]
        break

if virat_kohli_data:
    virat_kohli_tuple = (virat_kohli_data['name'], virat_kohli_data['country'])
    print(virat_kohli_tuple)
else:
    print("Virat Kohli not found")

#2. Iterate through the dataset and create a list of tuples, where each tuple contains the player's name and their number of wickets.
players_wickets = []

for player_id in cricket_dataset:
    player_data = cricket_dataset[player_id]
    player_name = player_data['name']

    num_wickets = player_data['stats'].get('wickets', 0)
    players_wickets.append((player_name, num_wickets))

print(players_wickets)

#3. Create a function that takes a country name as an argument and returns a tuple containing the names of all players from that country.
def get_players_by_country(country_name, dataset):
    player_names = []
    for player_id in dataset:
        player_data = dataset[player_id]
        if player_data['country'] == country_name:
            player_names.append(player_data['name'])
    return tuple(player_names)

indian_players = get_players_by_country("India", cricket_dataset)
print(f"Indian players: {indian_players}")

australian_players = get_players_by_country("Australia", cricket_dataset)
print(f"Australian players: {australian_players}")

#4. Create a list of tuples, with each tuple containing the player's name and their batting average. Sort this list based on the batting average.
players_and_averages = []

for player_id in cricket_dataset:
    player_data = cricket_dataset[player_id]

    player_name = player_data['name']
    batting_average = player_data['stats']['batting_average']
    players_and_averages.append((player_name, batting_average))

sorted_by_average = sorted(players_and_averages,key=lambda x: x[1], reverse=True)
print(sorted_by_average)

#5. Find the top 5 players with the highest batting average. Return a list of tuples, where each tuple contains the player's name and their batting average, sorted in descending order of the average.
player_averages = []
for player_id in cricket_dataset:
    player_data = cricket_dataset[player_id]
    player_name = player_data['name']
    batting_average = player_data['stats']['batting_average']
    player_averages.append((player_name, batting_average))

sorted_players = sorted(player_averages, key=lambda x: x[1], reverse=True)
top_5_players = sorted_players[:5]

print(top_5_players)

#Dictionary
#1. Write a Python program to retrieve and print the stats of a player named "Ben Stokes".
player_name = "Ben Stokes"
found_player_stats = None

for player_id in cricket_dataset:
    player_data = cricket_dataset[player_id]
    if player_data['name'] == player_name:
        found_player_stats = player_data['stats']
        break

if found_player_stats:
    print(f"Stats for {player_name}:")
    for stat_name, stat_value in found_player_stats.items():
        print(f"- {stat_name.replace('_', ' ').title()}: {stat_value}")
else:
    print(f"Player '{player_name}' not found")

#2. Add a new key-value pair, 'age': 35, to the dictionary of the player with the ID "player_05".
cricket_dataset["player_05"]["age"] = 35
print(f"Updated dictionary for player_05: {cricket_dataset['player_05']}")

#3. Create a new dictionary that contains the name and country of each player. The player ID should be the key, and a sub-dictionary with the name and country should be the value.
player_details = {}

for player_id, player_data in cricket_dataset.items():
    name = player_data['name']
    country = player_data['country']
    sub_dict = {'name': name, 'country': country}
    player_details[player_id] = sub_dict

print(player_details)

#4. Write a Python function that takes a country name as an argument and returns a dictionary of players from that country. The key of the new dictionary should be the player's ID, and the value should be the player's full profile dictionary.
def get_players_by_country_dict(country_name, dataset):
    players_from_country = {}
    for player_id, player_data in dataset.items():
        if player_data.get('country') == country_name:
            players_from_country[player_id] = player_data
    return players_from_country

india_team = get_players_by_country_dict("India", cricket_dataset)
australia_team = get_players_by_country_dict("Australia", cricket_dataset)
new_zealand_team = get_players_by_country_dict("New Zealand", cricket_dataset)

print("Indian Team:")
print(india_team)
print("\nAustralian Team:")
print(australia_team)
print("\nNew Zealand Team:")
print(new_zealand_team)

#5. Analyze the cricket_dataset to find the role that has the highest average batting_average across all players in that role. Return a dictionary with the role and its corresponding average.
role_averages = {}
role_counts = {}

for player_id, player_data in cricket_dataset.items():
    role = player_data['role']
    batting_average = player_data['stats']['batting_average']

    role_averages[role] = role_averages.get(role, 0.0) + batting_average
    role_counts[role] = role_counts.get(role, 0) + 1

final_averages = {}
for role in role_averages:
    final_averages[role] = role_averages[role] / role_counts[role]

highest_average_role = None
highest_average = 0

for role, average in final_averages.items():
    if average > highest_average:
        highest_average = average
        highest_average_role = role

result_dict = {highest_average_role: highest_average}
print(result_dict)

#Class and Objects
#1. Create a Player class with an __init__ method that takes player_id, name, and country as arguments and initializes the object.
class Player:
    def __init__(self, player_id, name, country):
        self.player_id = player_id
        self.name = name
        self.country = country

kohli_data = cricket_dataset["player_01"]
kohli_object = Player("player_01", kohli_data["name"], kohli_data["country"])

print(f"Created Player object for: {kohli_object.name}")
print(f"Player ID: {kohli_object.player_id}")
print(f"Country: {kohli_object.country}")

#2. Using the Player class from the previous question, create a player object for "Jasprit Bumrah".
class Player:
    def __init__(self, player_id, name, country):
        self.player_id = player_id
        self.name = name
        self.country = country

bumrah_id = None
bumrah_data = None

for p_id, p_data in cricket_dataset.items():
    if p_data['name'] == "Jasprit Bumrah":
        bumrah_id = p_id
        bumrah_data = p_data
        break

if bumrah_data:
    jasprit_bumrah_object = Player(bumrah_id, bumrah_data['name'], bumrah_data['country'])

    print(f"Created Player object for: {jasprit_bumrah_object.name}")
    print(f"Player ID: {jasprit_bumrah_object.player_id}")
    print(f"Country: {jasprit_bumrah_object.country}")
else:
    print("Jasprit Bumrah not found")

#3. Extend the Player class to include a stats attribute, which is a dictionary. Add a method get_stats that prints all the stats of the player. Create an object for Virat Kohli and use this method.
class Player:
    def __init__(self, name, country, role, batting_style, bowling_style, stats):
        self.name = name
        self.country = country
        self.role = role
        self.batting_style = batting_style
        self.bowling_style = bowling_style
        self.stats = stats

    def get_stats(self):
        print(f"Stats for {self.name}:")
        for key, value in self.stats.items():
            print(f"  {key.replace('_', ' ').title()}: {value}")

virat_kohli_data = cricket_dataset["player_01"]
virat_kohli = Player(
    virat_kohli_data["name"],
    virat_kohli_data["country"],
    virat_kohli_data["role"],
    virat_kohli_data["batting_style"],
    virat_kohli_data["bowling_style"],
    virat_kohli_data["stats"]
)
virat_kohli.get_stats()

#4. Add a method is_allrounder to the Player class that returns True if the player's role is "All-rounder", otherwise False.
class Player:
    def __init__(self, name, country, role, batting_style, bowling_style, stats,**kwargs):
        self.name = name
        self.country = country
        self.role = role
        self.batting_style = batting_style
        self.bowling_style = bowling_style
        self.stats = stats
        self.extra_data = kwargs

    def is_allrounder(self):
        return self.role == "All-rounder"


player_objects = {}
for player_id, data in cricket_dataset.items():
    player_objects[player_id] = Player(**data)

print(f"Is Virat Kohli an all-rounder? {player_objects['player_01'].is_allrounder()}")
print(f"Is Ben Stokes an all-rounder? {player_objects['player_04'].is_allrounder()}")
print(f"Is Rashid Khan an all-rounder? {player_objects['player_03'].is_allrounder()}")
print(f"Is Shakib Al Hasan an all-rounder? {player_objects['player_13'].is_allrounder()}")

#5. Create two classes: Player and Team. The Player class should store all player information. The Team class should have a method to add Player objects and a method to calculate the team's average batting average. Instantiate a Team object for India, add all Indian players to it, and calculate the team's average batting average.
class Player:
    def __init__(self, name, country, role, batting_style, bowling_style, stats):
        self.name = name
        self.country = country
        self.role = role
        self.batting_style = batting_style
        self.bowling_style = bowling_style
        self.stats = stats

    def is_allrounder(self):
        return self.role == "All-rounder"


class Team:
    def __init__(self, name):
        self.name = name
        self.players = []

    def add_player(self, player):
        if isinstance(player, Player):
            self.players.append(player)
        else:
            print(f"Error: {player} is not a valid Player object.")

    def calculate_average_batting_average(self):
        if not self.players:
            return 0
        total_batting_average = 0
        for player in self.players:
            total_batting_average += player.stats["batting_average"]
        return total_batting_average / len(self.players)


team_india = Team("India")

for player_id, player_data in cricket_dataset.items():
    if player_data["country"] == "India":
        player = Player(
            name=player_data["name"],
            country=player_data["country"],
            role=player_data["role"],
            batting_style=player_data["batting_style"],
            bowling_style=player_data["bowling_style"],
            stats=player_data["stats"]
        )
        team_india.add_player(player)

india_avg_batting_average = team_india.calculate_average_batting_average()

print(f"The average of batting average for Team {team_india.name} is: {india_avg_batting_average:.2f}")
print(f"\nIndian players in Team {team_india.name}:")
print("| Player Name        | Role           | Batting Average |")
print("|--------------------|----------------|-----------------|")
for player in team_india.players:
    print(f"| {player.name:<18} | {player.role:<14} | {player.stats['batting_average']:<15.2f} |")