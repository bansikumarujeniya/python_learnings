employee_data = [
    {
        "id": 1,
        "name": "Amber Peterson",
        "email": "cwilson@example.net",
        "job_title": "Editor, commissioning",
        "company": "Smith, Mcdonald and Hernandez",
        "address": "7616 Amanda Inlet\nEast William, OR 07705",
        "last_login": "2020-03-24"
    },
    {
        "id": 2,
        "name": "Jason Anderson",
        "email": "kellyrobert@example.org",
        "job_title": "Occupational psychologist",
        "company": "Johnson, Rodriguez and Fisher",
        "address": "PSC 6323, Box 6006\nAPO AP 40228",
        "last_login": "2024-03-10"
    },
    {
        "id": 3,
        "name": "Timothy Evans",
        "email": "wthompson@example.net",
        "job_title": "Pharmacist",
        "company": "Sanchez, Rodriguez and Diaz",
        "address": "298 Sanchez Drive\nSouth Angelamouth, NH 69652",
        "last_login": "2022-10-18"
    },
    {
        "id": 4,
        "name": "Mr. Jesse Ramirez",
        "email": "karl16@example.com",
        "job_title": "IT technical support professional",
        "company": "White, Ramirez and Jones",
        "address": "813 James Path\nSouth Annaburgh, UT 27329",
        "last_login": "2021-08-01"
    },
    {
        "id": 5,
        "name": "Mary Hall",
        "email": "christine91@example.org",
        "job_title": "Physiotherapist",
        "company": "Lee Group",
        "address": "3391 David Stream Suite 357\nEast Stephenfurt, IL 42967",
        "last_login": "2020-11-20"
    },
    {
        "id": 6,
        "name": "Scott Miller",
        "email": "kellermeredith@example.com",
        "job_title": "Air cabin crew",
        "company": "Turner PLC",
        "address": "8064 Anderson Stream Apt. 367\nNorth Michaelmouth, CO 95537",
        "last_login": "2020-01-20"
    },
    {
        "id": 7,
        "name": "Lisa Morgan",
        "email": "jessica97@example.com",
        "job_title": "Conservation officer",
        "company": "Hernandez-Lopez",
        "address": "76159 Scott Plaza Suite 837\nSouth Jamesbury, MI 49959",
        "last_login": "2024-08-25"
    },
    {
        "id": 8,
        "name": "Mary Torres",
        "email": "kenneth47@example.net",
        "job_title": "Museum education officer",
        "company": "Russell and Sons",
        "address": "28358 Michael Inlet\nNorth Crystal, SC 60925",
        "last_login": "2024-03-24"
    },
    {
        "id": 9,
        "name": "Jeffrey Thomas",
        "email": "wturner@example.net",
        "job_title": "Scientist, water quality",
        "company": "Brown-Johnson",
        "address": "97029 Lisa Port Apt. 522\nEast Kevin, OK 22444",
        "last_login": "2024-08-08"
    },
    {
        "id": 10,
        "name": "Ashley Hill",
        "email": "lisa45@example.org",
        "job_title": "Retail merchandiser",
        "company": "Baker, Wilson and Lee",
        "address": "4092 Williams Flat Suite 350\nNorth James, OK 16867",
        "last_login": "2022-09-24"
    },
    {
        "id": 11,
        "name": "Christopher Lopez",
        "email": "dianabrown@example.net",
        "job_title": "Production manager",
        "company": "Jones-Thompson",
        "address": "908 Stephanie Creek\nWest Jessicaville, ND 71754",
        "last_login": "2024-09-02"
    },
    {
        "id": 12,
        "name": "Lisa Harris",
        "email": "garciakelly@example.org",
        "job_title": "Advertising account executive",
        "company": "Peterson-Hernandez",
        "address": "15370 Thomas Walk\nWest Christopher, HI 75787",
        "last_login": "2023-01-20"
    },
    {
        "id": 13,
        "name": "David Ramirez",
        "email": "johnnelson@example.net",
        "job_title": "Advertising account executive",
        "company": "Smith, Mcdonald and Hernandez",
        "address": "66481 Russell Islands\nSouth Johnport, PA 35326",
        "last_login": "2023-10-21"
    },
    {
        "id": 14,
        "name": "Richard Garcia",
        "email": "hickskatherine@example.org",
        "job_title": "Horticultural consultant",
        "company": "Johnson, Rodriguez and Fisher",
        "address": "76949 Amy Pike Suite 174\nMartinezland, WV 96627",
        "last_login": "2024-06-03"
    },
    {
        "id": 15,
        "name": "Matthew Hernandez",
        "email": "robert84@example.com",
        "job_title": "Air cabin crew",
        "company": "Sanchez, Rodriguez and Diaz",
        "address": "298 Jessica Valley\nEast Joseph, AR 13190",
        "last_login": "2021-02-13"
    },
    {
        "id": 16,
        "name": "Joseph Smith",
        "email": "christopher36@example.org",
        "job_title": "Building surveyor",
        "company": "White, Ramirez and Jones",
        "address": "9935 Anthony Stream Apt. 182\nSouth Anthonychester, IN 67676",
        "last_login": "2021-05-19"
    },
    {
        "id": 17,
        "name": "Michael Davis",
        "email": "jessica82@example.org",
        "job_title": "Social researcher",
        "company": "Lee Group",
        "address": "7567 James Drive\nLake Jessicaborough, WY 91873",
        "last_login": "2024-07-28"
    },
    {
        "id": 18,
        "name": "Lisa Morgan",
        "email": "mark27@example.org",
        "job_title": "Retail merchandiser",
        "company": "Turner PLC",
        "address": "733 Ryan Alley\nWest Elizabethhaven, SC 76953",
        "last_login": "2024-02-15"
    },
    {
        "id": 19,
        "name": "Lisa Harris",
        "email": "thomas93@example.net",
        "job_title": "Architect",
        "company": "Hernandez-Lopez",
        "address": "2296 Johnson Stream\nWest Amy, AZ 15632",
        "last_login": "2024-04-10"
    },
    {
        "id": 20,
        "name": "Paul Rodriguez",
        "email": "wcoleman@example.net",
        "job_title": "Surveyor, rural practice",
        "company": "Russell and Sons",
        "address": "98144 Brown Island\nWest Nicolemouth, PA 24706",
        "last_login": "2023-08-11"
    },
    {
        "id": 21,
        "name": "Kimberly Miller",
        "email": "sarah04@example.org",
        "job_title": "Public relations officer",
        "company": "Brown-Johnson",
        "address": "71395 Steven Parks\nSouth Sarahport, SC 66532",
        "last_login": "2023-01-22"
    },
    {
        "id": 22,
        "name": "Jennifer Garcia",
        "email": "qpeterson@example.org",
        "job_title": "Scientist, water quality",
        "company": "Baker, Wilson and Lee",
        "address": "9360 Jason Ramp\nSouth Jessica, OK 20387",
        "last_login": "2023-04-09"
    },
    {
        "id": 23,
        "name": "Michael Davis",
        "email": "qwalker@example.net",
        "job_title": "Public relations officer",
        "company": "Jones-Thompson",
        "address": "708 Johnson Pass Suite 692\nMichaelmouth, TN 15848",
        "last_login": "2022-04-20"
    },
    {
        "id": 24,
        "name": "Eric Smith",
        "email": "sandra77@example.com",
        "job_title": "Editor, commissioning",
        "company": "Peterson-Hernandez",
        "address": "596 Johnson Creek Suite 086\nLake James, VT 04051",
        "last_login": "2024-08-01"
    },
    {
        "id": 25,
        "name": "Matthew Hernandez",
        "email": "cwilson@example.net",
        "job_title": "Production manager",
        "company": "Smith, Mcdonald and Hernandez",
        "address": "2525 Rachel Locks Apt. 182\nNorth Elizabeth, WY 51475",
        "last_login": "2023-08-17"
    },
    {
        "id": 26,
        "name": "Richard Garcia",
        "email": "jason10@example.com",
        "job_title": "Air cabin crew",
        "company": "Johnson, Rodriguez and Fisher",
        "address": "6964 Daniel Drive\nWest Brian, ID 42805",
        "last_login": "2024-05-24"
    },
    {
        "id": 27,
        "name": "Matthew Hernandez",
        "email": "jennifer11@example.net",
        "job_title": "Horticultural consultant",
        "company": "Sanchez, Rodriguez and Diaz",
        "address": "632 Mark Alley\nNorth Michaelhaven, VT 68133",
        "last_login": "2022-04-18"
    },
    {
        "id": 28,
        "name": "Jennifer Garcia",
        "email": "jessica82@example.org",
        "job_title": "Building surveyor",
        "company": "White, Ramirez and Jones",
        "address": "2138 Johnson Alley Suite 092\nNorth Scottmouth, OK 49673",
        "last_login": "2024-01-20"
    },
    {
        "id": 29,
        "name": "Paul Rodriguez",
        "email": "patrick96@example.net",
        "job_title": "Social researcher",
        "company": "Lee Group",
        "address": "644 Scott Pass\nNorth Scott, ID 44342",
        "last_login": "2021-08-07"
    },
    {
        "id": 30,
        "name": "Kimberly Miller",
        "email": "rebeccamartinez@example.com",
        "job_title": "Architect",
        "company": "Turner PLC",
        "address": "416 Mary Mission Apt. 949\nChristinamouth, TX 11444",
        "last_login": "2022-07-28"
    }]

#Lists
#1. Extract Specific Data: From the provided dataset, write a Python script to create and print a new list containing only the name of the first 5 entries.
first_five_names = [employee['name'] for employee in employee_data[:5]]
print(first_five_names)

#2. Filter by Condition: Write a Python function that accepts the dataset and a job title string as input. The function should return a list of dictionaries where the job_title matches the given string.
def filter_by_job_title_lc(data, job_title):
    return [employee for employee in data if employee['job_title'] == job_title]

job_to_find = "Public relations officer"
filtered_employees = filter_by_job_title_lc(employee_data, job_to_find)

print(f"Employees with the job title '{job_to_find}':")
for employee in filtered_employees:
    print(employee)

job_to_find_2 = "Architect"
filtered_employees_2 = filter_by_job_title_lc(employee_data, job_to_find_2)

print(f"\nEmployees with the job title '{job_to_find_2}':")
for employee in filtered_employees_2:
    print(employee)

#3. Transform and Sort: Create a new list containing tuples of (name, company) for each entry in the dataset. Then, sort this new list alphabetically by the company name and print the result.
name_company_tuples = [(entry['name'], entry['company']) for entry in employee_data]
sorted_by_company = sorted(name_company_tuples, key=lambda x: x[1])

for item in sorted_by_company:
    print(item)

#4. Aggregation: Calculate and return the total number of unique job titles present in the dataset.

def count_unique_job_titles(dataset):
    job_titles = [entry['job_title'] for entry in dataset]
    unique_job_titles = set(job_titles)
    return len(unique_job_titles)

total_unique_job_titles = count_unique_job_titles(employee_data)
print(f"Total number of unique job titles: {total_unique_job_titles}")

#5. Performance with Nested Lists: Create a function that, given the dataset, efficiently counts the number of times a company has a new employee logging in after their previous login timestamp. The function should store the login history in a nested list structure for each company, demonstrating how nested lists impact performance for this type of repeated, cross-referencing operation.
from datetime import datetime

def count_new_logins_with_nested_lists(employee_data):

    company_login_history = []
    new_login_count = {}

    for employee in employee_data:
        company_name = employee['company']
        employee_name = employee['name']
        last_login_str = employee['last_login']
        current_login_date = datetime.strptime(last_login_str, '%Y-%m-%d')

        company_found = False
        for company_record in company_login_history:
            if company_record[0] == company_name:
                company_found = True
                login_history = company_record[1]

                found_match = False
                for login_entry in login_history:
                    if login_entry[0] == employee_name:
                        found_match = True
                        previous_login_date = login_entry[1]
                        if current_login_date > previous_login_date:
                            new_login_count[company_name] = new_login_count.get(company_name, 0) + 1
                            login_entry[1] = current_login_date
                        break

                if not found_match:
                    login_history.append([employee_name, current_login_date])
                break

        if not company_found:
            company_login_history.append([company_name, [[employee_name, current_login_date]]])

    return new_login_count


login_counts_nested = count_new_logins_with_nested_lists(employee_data)
print(login_counts_nested)