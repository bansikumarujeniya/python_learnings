politician_dataset = [
    {
        "name": "Narendra Modi",
        "position": "Prime Minister of India",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "Varanasi, Uttar Pradesh",
        "start_date": "26 May 2014"
    },
    {
        "name": "Droupadi Murmu",
        "position": "President of India",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "N/A",
        "start_date": "25 July 2022"
    },
    {
        "name": "C. P. Radhakrishnan",
        "position": "Vice President of India",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "N/A",
        "start_date": "9 September 2025"
    },
    {
        "name": "Rajnath Singh",
        "position": "Union Minister of Defence",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "Lucknow, Uttar Pradesh",
        "start_date": "N/A"
    },
    {
        "name": "Amit Shah",
        "position": "Union Minister of Home Affairs and Minister of Cooperation",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "Gandhinagar, Gujarat",
        "start_date": "30 May 2019"
    },
    {
        "name": "Nitin Gadkari",
        "position": "Union Minister of Road Transport and Highways",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "Nagpur, Maharashtra",
        "start_date": "N/A"
    },
    {
        "name": "Jagat Prakash Nadda",
        "position": "Union Minister of Health and Family Welfare",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "N/A",
        "start_date": "N/A"
    },
    {
        "name": "Shivraj Singh Chouhan",
        "position": "Union Minister of Agriculture and Farmers Welfare and Minister of Rural Development",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "Vidisha, Madhya Pradesh",
        "start_date": "N/A"
    },
    {
        "name": "Nirmala Sitharaman",
        "position": "Union Minister of Finance and Minister of Corporate Affairs",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "N/A",
        "start_date": "N/A"
    },
    {
        "name": "S. Jaishankar",
        "position": "Union Minister of External Affairs",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "N/A",
        "start_date": "N/A"
    },
    {
        "name": "Piyush Goyal",
        "position": "Union Minister of Commerce and Industry",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "N/A",
        "start_date": "N/A"
    },
    {
        "name": "Dharmendra Pradhan",
        "position": "Union Minister of Education",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "N/A",
        "start_date": "N/A"
    },
    {
        "name": "Ashwini Vaishnaw",
        "position": "Union Minister of Railways, Information & Broadcasting, and Electronics & Information Technology",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "N/A",
        "start_date": "N/A"
    },
    {
        "name": "Kiren Rijiju",
        "position": "Union Minister of Parliamentary Affairs and Minister of Minority Affairs",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "Arunachal West, Arunachal Pradesh",
        "start_date": "N/A"
    },
    {
        "name": "Pramod Sawant",
        "position": "Chief Minister of Goa",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "Sanquelim, Goa",
        "start_date": "19 March 2019"
    },
    {
        "name": "Bhupendra Patel",
        "position": "Chief Minister of Gujarat",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "Ghatlodia, Gujarat",
        "start_date": "13 September 2021"
    },
    {
        "name": "Nayab Singh Saini",
        "position": "Chief Minister of Haryana",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "N/A",
        "start_date": "12 March 2024"
    },
    {
        "name": "Sukhvinder Singh Sukhu",
        "position": "Chief Minister of Himachal Pradesh",
        "party": "Indian National Congress (INC)",
        "constituency": "Nadaun, Himachal Pradesh",
        "start_date": "11 December 2022"
    },
    {
        "name": "Hemant Soren",
        "position": "Chief Minister of Jharkhand",
        "party": "Jharkhand Mukti Morcha (JMM)",
        "constituency": "Barhait, Jharkhand",
        "start_date": "N/A"
    },
    {
        "name": "Siddaramaiah",
        "position": "Chief Minister of Karnataka",
        "party": "Indian National Congress (INC)",
        "constituency": "Varuna, Karnataka",
        "start_date": "20 May 2023"
    },
    {
        "name": "Pinarayi Vijayan",
        "position": "Chief Minister of Kerala",
        "party": "Communist Party of India (Marxist)",
        "constituency": "Dharmadam, Kerala",
        "start_date": "25 May 2016"
    },
    {
        "name": "Mohan Yadav",
        "position": "Chief Minister of Madhya Pradesh",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "Ujjain Dakshin, Madhya Pradesh",
        "start_date": "13 December 2023"
    },
    {
        "name": "Devendra Fadnavis",
        "position": "Chief Minister of Maharashtra",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "Nagpur South West, Maharashtra",
        "start_date": "N/A"
    },
    {
        "name": "Bhagwant Mann",
        "position": "Chief Minister of Punjab",
        "party": "Aam Aadmi Party (AAP)",
        "constituency": "Dhuri, Punjab",
        "start_date": "16 March 2022"
    },
    {
        "name": "Bhajan Lal Sharma",
        "position": "Chief Minister of Rajasthan",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "Sanganer, Rajasthan",
        "start_date": "15 December 2023"
    },
    {
        "name": "M. K. Stalin",
        "position": "Chief Minister of Tamil Nadu",
        "party": "Dravida Munnetra Kazhagam (DMK)",
        "constituency": "Kolathur, Tamil Nadu",
        "start_date": "7 May 2021"
    },
    {
        "name": "Yogi Adityanath",
        "position": "Chief Minister of Uttar Pradesh",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "N/A",
        "start_date": "19 March 2017"
    },
    {
        "name": "Mamata Banerjee",
        "position": "Chief Minister of West Bengal",
        "party": "All India Trinamool Congress (TMC)",
        "constituency": "Bhabanipur, West Bengal",
        "start_date": "20 May 2011"
    },
    {
        "name": "Akhilesh Yadav",
        "position": "Leader of the Opposition (Lok Sabha)",
        "party": "Samajwadi Party (SP)",
        "constituency": "Kannauj, Uttar Pradesh",
        "start_date": "N/A"
    },
    {
        "name": "Rahul Gandhi",
        "position": "Member of Parliament (Lok Sabha)",
        "party": "Indian National Congress (INC)",
        "constituency": "Rae Bareli, Uttar Pradesh",
        "start_date": "N/A"
    }
]

#Lists
#1. Get names: Make a new list that holds only the names of all the politicians.
names_list = []

for politician in politician_dataset:
    names_list.append(politician["name"])

print(names_list)

#2. Filter by party: Write a function that finds all politicians from a given party, like the "Bharatiya Janata Party (BJP)".
def filter_by_party(politician_dataset, party_name):
    return [politician for politician in politician_dataset if politician["party"] == party_name]

bjp_politicians = filter_by_party(politician_dataset, "Bharatiya Janata Party (BJP)")
for p in bjp_politicians:
    print(f"Name: {p['name']}, Position: {p['position']}")

#3. Unique parties: Find all the different political parties in the list and put them in a new list.
def find_unique_parties(politician_dataset):
    unique_parties = set()
    for politician in politician_dataset:
        unique_parties.add(politician["party"])
    return list(unique_parties)

all_unique_parties = find_unique_parties(politician_dataset)
print("All unique parties:", all_unique_parties)

#4. Count by party: Create a program that counts how many politicians are in each political party.
def count_politicians_by_party(dataset):
    party_counts = {}
    for politician in dataset:
        party = politician.get("party")
        if party:
            party_counts[party] = party_counts.get(party, 0) + 1
    return party_counts

party_counts = count_politicians_by_party(politician_dataset)

for party, count in party_counts.items():
    print(f"{party}: {count}")

#5. Find longest-serving: Find the politician who has been in office the longest. Be careful with entries that have missing or incomplete start dates.
import datetime

def find_longest_serving_politician(dataset):
    longest_tenure_politician = None
    longest_tenure_days = -1

    today = datetime.date.today()

    for politician in dataset:
        start_date_str = politician.get("start_date")

        if not start_date_str or start_date_str == "N/A":
            continue

        try:
            start_date = datetime.datetime.strptime(start_date_str, "%d %B %Y").date()
            tenure_days = (today - start_date).days

            if tenure_days > longest_tenure_days:
                longest_tenure_days = tenure_days
                longest_tenure_politician = politician

        except ValueError:
            print(f"Warning: Could not parse date for {politician.get('name')}: {start_date_str}")
            continue

    return longest_tenure_politician

longest_serving = find_longest_serving_politician(politician_dataset)

if longest_serving:
    print("The longest-serving politician is:")
    print(f"Name: {longest_serving.get('name')}")
    print(f"Position: {longest_serving.get('position')}")
    print(f"Party: {longest_serving.get('party')}")
    print(f"Start Date: {longest_serving.get('start_date')}")
else:
    print("Could not determine the longest-serving politician from the provided data.")

#Tuples
#1. Create name-party tuples: Make a list where each item is a pair (a tuple) containing a politician's name and their party.
name_party_tuples = [(p["name"], p["party"]) for p in politician_dataset]

for item in name_party_tuples:
    print(item)

#2. Basic named tuple: Create a special type of tuple for a politician that has fields for name, position, and party.
list_of_tuples = [(p["name"], p["position"], p["party"]) for p in politician_dataset]
tuple_of_tuples = tuple(list_of_tuples)

for item in tuple_of_tuples:
    print(item)

#3. Save politician details: Store the name, position, and voting area (constituency) for a politician like 'Bhagwant Mann' in an unchanging tuple. Explain why a tuple is a good choice for this.
def get_politician_tuple(name, dataset):
    for politician in dataset:
        if politician["name"] == name:
            return (politician["name"], politician["position"], politician["constituency"])
    return None

bhagwant_mann_details = get_politician_tuple("Bhagwant Mann", politician_dataset)

if bhagwant_mann_details:
    print("Bhagwant Mann's details as a tuple:")
    print(bhagwant_mann_details)
    print("\nWhy a tuple is a good choice for this data:")
    print(
        "1. Immutability: The data (name, position, voting area) is fixed and should not be changed after creation. A tuple's immutability ensures this data integrity.")
    print(
        "2. Performance: Tuples are slightly more memory-efficient and can be faster to process than lists, especially when dealing with fixed records.")
    print(
        "3. Readability and Intent: Using a tuple signals to other developers that this is a fixed, ordered collection of related items, improving code clarity.")
else:
    print("Politician 'Bhagwant Mann' not found in the dataset.")

#4. Sort by party: Create a sorted list of pairs (tuples), with the party name first and the politician's name second.
party_name_list = sorted([(p["party"], p["name"]) for p in politician_dataset])

sorted_politicians_tuple = tuple(party_name_list)

print(sorted_politicians_tuple)

#5. Check for duplicate entries: Write a program that looks for duplicate politicians by checking if they have the same name and voting area (constituency). Your program should list any duplicate entries it finds.
def find_duplicate_politicians(data):
    seen = set()
    duplicates = []
    for politician in data:
        identifier = (politician["name"], politician["constituency"])
        if identifier in seen:
            duplicates.append(politician)
        else:
            seen.add(identifier)
    return duplicates

duplicate_entries = find_duplicate_politicians(politician_dataset)

if duplicate_entries:
    print("Found duplicate entries:")
    for entry in duplicate_entries:
        print(f"  - Name: {entry['name']}, Constituency: {entry['constituency']}")
else:
    print("No duplicate entries found based on name and constituency.")

#Dictionary
#1. Find by name: Write a function that searches for a politician by name and gives you their full information.
def find_politician_by_name(dataset, name):
    for politician in dataset:
        if politician["name"].lower() == name.lower():
            return politician
    return None

politician_info = find_politician_by_name(politician_dataset, "Amit Shah")

if politician_info:
    print(politician_info)
else:
    print("Politician not found.")

#2. Update information: Change the start_date for a politician like 'Rajnath Singh', whose date is currently "N/A".
def update_politician_info(dataset, name, key, new_value):
    for politician in dataset:
        if politician["name"].lower() == name.lower():
            politician[key] = new_value
            return True
    return False

update_politician_info(politician_dataset, "Rajnath Singh", "start_date", "1 June 2019")

rajnath_singh_info = None
for politician in politician_dataset:
    if politician["name"] == "Rajnath Singh":
        rajnath_singh_info = politician
        break

if rajnath_singh_info:
    print("Updated information for Rajnath Singh:")
    print(rajnath_singh_info)
else:
    print("Politician not found.")

#3. Group by party: Organize all the politicians into a single dictionary. The keys should be the political parties, and the values should be a list of all the politicians in that party.
from collections import defaultdict

def group_politicians_by_party(dataset):
    grouped_by_party = defaultdict(list)
    for politician in dataset:
        party = politician["party"]
        grouped_by_party[party].append(politician)
    return dict(grouped_by_party)


politicians_by_party = group_politicians_by_party(politician_dataset)

import pprint

pprint.pprint(politicians_by_party)

#4. Group by state: Create a dictionary that groups politicians by their state, which is found in their constituency field.
from collections import defaultdict

def group_politicians_by_state(dataset):
    grouped_by_state = defaultdict(list)
    for politician in dataset:
        constituency = politician.get("constituency")

        if constituency == "N/A" or not constituency:
            state = "N/A"
        else:
            state = constituency.split(',')[-1].strip()
        grouped_by_state[state].append(politician)

    return dict(grouped_by_state)

politicians_by_state = group_politicians_by_state(politician_dataset)

import pprint
pprint.pprint(politicians_by_state)

#5. Create custom groups: Write a function that takes a list of field names (like name and party) and uses them to create a new dictionary. The keys should combine the values of those fields (e.g., 'Narendra Modi_BJP'), and the value should be the politician's full information.
def create_custom_groups(dataset, fields_to_group):
    grouped_data = {}
    for item in dataset:
        key_parts = [str(item.get(field)) for field in fields_to_group if field in item]
        if key_parts:
            combined_key = "_".join(key_parts)
            grouped_data[combined_key] = item
    return grouped_data

grouped_by_name_and_party = create_custom_groups(politician_dataset, ["name", "party"])
print(grouped_by_name_and_party.get("Narendra Modi_Bharatiya Janata Party (BJP)"))

#Class and Objects
#1. Create a Politician blueprint: Write a class called Politician that can hold information like a politician's name, position, and party.
class Politician:
    def __init__(self, name, position, party, constituency, start_date):
        self.name = name
        self.position = position
        self.party = party
        self.constituency = constituency
        self.start_date = start_date

    def __str__(self):
        return f"{self.name} ({self.party}) - {self.position}"

politician_objects = [
    Politician(
        name=data["name"],
        position=data["position"],
        party=data["party"],
        constituency=data["constituency"],
        start_date=data["start_date"]
    )
    for data in politician_dataset
]

print("--- Using the Politician Class ---")
for politician in politician_objects:
    print(politician)

#2. Make a politician: Create a new Politician object for 'Yogi Adityanath' and display their information.
politician_info = None
for politician in politician_dataset:
    if politician["name"] == "Yogi Adityanath":
        politician_info = politician
        break

if politician_info:
    print("Politician Found:")
    for key, value in politician_info.items():
        print(f"{key.replace('_', ' ').title()}: {value}")
else:
    print("Politician 'Yogi Adityanath' not found in the dataset.")

#3. Add a filter: Add a feature to your Politician class to find all politicians who belong to a certain party.
class Politician:
    def __init__(self, name, position, party, constituency, start_date):
        self.name = name
        self.position = position
        self.party = party
        self.constituency = constituency
        self.start_date = start_date

    def __repr__(self):
        return f'Politician(name="{self.name}", party="{self.party}")'

    @classmethod
    def find_by_party(cls, politicians_data, party_name):
        return [
            cls(p["name"], p["position"], p["party"], p["constituency"], p["start_date"])
            for p in politicians_data
            if p["party"].lower() == party_name.lower()
        ]


bjp_politicians = Politician.find_by_party(politician_dataset, "Bharatiya Janata Party (BJP)")
inc_politicians = Politician.find_by_party(politician_dataset, "Indian National Congress (INC)")
dmk_politicians = Politician.find_by_party(politician_dataset, "Dravida Munnetra Kazhagam (DMK)")
tmc_politicians = Politician.find_by_party(politician_dataset, "All India Trinamool Congress (TMC)")
aap_politicians = Politician.find_by_party(politician_dataset, "Aam Aadmi Party (AAP)")

print(f"Politicians from BJP ({len(bjp_politicians)} found):")
for p in bjp_politicians:
    print(f"- {p.name}")

print("\n" + "-" * 30 + "\n")
print(f"Politicians from INC ({len(inc_politicians)} found):")
for p in inc_politicians:
    print(f"- {p.name}")

print("\n" + "-" * 30 + "\n")
print(f"Politicians from Dravida Munnetra Kazhagam (DMK) ({len(dmk_politicians)} found):")
for p in dmk_politicians:
    print(f"- {p.name}")

print("\n" + "-" * 30 + "\n")
print(f"Politicians from All India Trinamool Congress (TMC) ({len(tmc_politicians)} found):")
for p in tmc_politicians:
    print(f"- {p.name}")

print("\n" + "-" * 30 + "\n")
print(f"Politicians from Aam Aadmi Party (AAP) ({len(aap_politicians)} found):")
for p in aap_politicians:
    print(f"- {p.name}")

#4. Organize objects: Make a list of Politician objects from the dataset. Then, create a function that puts these objects into a dictionary, grouping them by their position.
from collections import defaultdict

class Politician:
    def __init__(self, name, position, party, constituency, start_date):
        self.name = name
        self.position = position
        self.party = party
        self.constituency = constituency
        self.start_date = start_date

    def __repr__(self):
        return f"Politician('{self.name}', '{self.position}')"

def create_politician_objects(dataset):
    politician_objects = []
    for data in dataset:
        politician_objects.append(
            Politician(
                data["name"],
                data["position"],
                data["party"],
                data["constituency"],
                data["start_date"],
            )
        )
    return politician_objects

def group_by_position(politician_list):
    grouped_by_position = defaultdict(list)
    for politician in politician_list:
        grouped_by_position[politician.position].append(politician)
    return dict(grouped_by_position)

all_politicians = create_politician_objects(politician_dataset)

politicians_by_position = group_by_position(all_politicians)

for position, politicians in politicians_by_position.items():
    print(f"--- {position} ---")
    for politician in politicians:
        print(f"  - {politician.name}")
    print()

#5. Create a special class: Create a main Politician class. Then, make a new, more specific ChiefMinister class that adds a function to break down the constituency into the city and state. Use this to create an object for a chief minister.
class Politician:
    def __init__(self, name, position, party, constituency, start_date):
        self.name = name
        self.position = position
        self.party = party
        self.constituency = constituency
        self.start_date = start_date


class ChiefMinister(Politician):
    def __init__(self, name, position, party, constituency, start_date):
        super().__init__(name, position, party, constituency, start_date)
        self.city = "N/A"
        self.state = "N/A"
        self.break_down_constituency()

    def break_down_constituency(self):
        if self.constituency != "N/A":
            parts = [p.strip() for p in self.constituency.split(',')]
            if len(parts) == 2:
                self.city = parts[0]
                self.state = parts[1]


def find_chief_ministers(dataset):
    return [p for p in dataset if "Chief Minister" in p["position"]]

def main():
    cm_data = find_chief_ministers(politician_dataset)
    if cm_data:
        first_cm_dict = cm_data[0]
        cm_object = ChiefMinister(
            name=first_cm_dict["name"],
            position=first_cm_dict["position"],
            party=first_cm_dict["party"],
            constituency=first_cm_dict["constituency"],
            start_date=first_cm_dict["start_date"]
        )

        print(f"Created ChiefMinister object for: {cm_object.name}\n")
        print("Original Details:")
        print(f"Name: {cm_object.name}")
        print(f"Position: {cm_object.position}")
        print(f"Constituency: {cm_object.constituency}\n")
        print("Constituency Breakdown:")
        print(f"City: {cm_object.city}")
        print(f"State: {cm_object.state}")
    else:
        print("No Chief Ministers found in the dataset.")


if __name__ == "__main__":
    main()