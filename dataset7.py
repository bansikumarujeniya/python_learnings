politician_dataset = [
    {
        "name": "Narendra Modi",
        "position": "Prime Minister of India",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "Varanasi, Uttar Pradesh",
        "start_date": "26 May 2014"
    },
    {
        "name": "Droupadi Murmu",
        "position": "President of India",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "N/A",
        "start_date": "25 July 2022"
    },
    {
        "name": "C. P. Radhakrishnan",
        "position": "Vice President of India",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "N/A",
        "start_date": "9 September 2025"
    },
    {
        "name": "Rajnath Singh",
        "position": "Union Minister of Defence",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "Lucknow, Uttar Pradesh",
        "start_date": "N/A"
    },
    {
        "name": "Amit Shah",
        "position": "Union Minister of Home Affairs and Minister of Cooperation",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "Gandhinagar, Gujarat",
        "start_date": "30 May 2019"
    },
    {
        "name": "Nitin Gadkari",
        "position": "Union Minister of Road Transport and Highways",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "Nagpur, Maharashtra",
        "start_date": "N/A"
    },
    {
        "name": "Jagat Prakash Nadda",
        "position": "Union Minister of Health and Family Welfare",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "N/A",
        "start_date": "N/A"
    },
    {
        "name": "Shivraj Singh Chouhan",
        "position": "Union Minister of Agriculture and Farmers Welfare and Minister of Rural Development",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "Vidisha, Madhya Pradesh",
        "start_date": "N/A"
    },
    {
        "name": "Nirmala Sitharaman",
        "position": "Union Minister of Finance and Minister of Corporate Affairs",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "N/A",
        "start_date": "N/A"
    },
    {
        "name": "S. Jaishankar",
        "position": "Union Minister of External Affairs",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "N/A",
        "start_date": "N/A"
    },
    {
        "name": "Piyush Goyal",
        "position": "Union Minister of Commerce and Industry",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "N/A",
        "start_date": "N/A"
    },
    {
        "name": "Dharmendra Pradhan",
        "position": "Union Minister of Education",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "N/A",
        "start_date": "N/A"
    },
    {
        "name": "Ashwini Vaishnaw",
        "position": "Union Minister of Railways, Information & Broadcasting, and Electronics & Information Technology",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "N/A",
        "start_date": "N/A"
    },
    {
        "name": "Kiren Rijiju",
        "position": "Union Minister of Parliamentary Affairs and Minister of Minority Affairs",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "Arunachal West, Arunachal Pradesh",
        "start_date": "N/A"
    },
    {
        "name": "Pramod Sawant",
        "position": "Chief Minister of Goa",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "Sanquelim, Goa",
        "start_date": "19 March 2019"
    },
    {
        "name": "Bhupendra Patel",
        "position": "Chief Minister of Gujarat",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "Ghatlodia, Gujarat",
        "start_date": "13 September 2021"
    },
    {
        "name": "Nayab Singh Saini",
        "position": "Chief Minister of Haryana",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "N/A",
        "start_date": "12 March 2024"
    },
    {
        "name": "Sukhvinder Singh Sukhu",
        "position": "Chief Minister of Himachal Pradesh",
        "party": "Indian National Congress (INC)",
        "constituency": "Nadaun, Himachal Pradesh",
        "start_date": "11 December 2022"
    },
    {
        "name": "Hemant Soren",
        "position": "Chief Minister of Jharkhand",
        "party": "Jharkhand Mukti Morcha (JMM)",
        "constituency": "Barhait, Jharkhand",
        "start_date": "N/A"
    },
    {
        "name": "Siddaramaiah",
        "position": "Chief Minister of Karnataka",
        "party": "Indian National Congress (INC)",
        "constituency": "Varuna, Karnataka",
        "start_date": "20 May 2023"
    },
    {
        "name": "Pinarayi Vijayan",
        "position": "Chief Minister of Kerala",
        "party": "Communist Party of India (Marxist)",
        "constituency": "Dharmadam, Kerala",
        "start_date": "25 May 2016"
    },
    {
        "name": "Mohan Yadav",
        "position": "Chief Minister of Madhya Pradesh",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "Ujjain Dakshin, Madhya Pradesh",
        "start_date": "13 December 2023"
    },
    {
        "name": "Devendra Fadnavis",
        "position": "Chief Minister of Maharashtra",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "Nagpur South West, Maharashtra",
        "start_date": "N/A"
    },
    {
        "name": "Bhagwant Mann",
        "position": "Chief Minister of Punjab",
        "party": "Aam Aadmi Party (AAP)",
        "constituency": "Dhuri, Punjab",
        "start_date": "16 March 2022"
    },
    {
        "name": "Bhajan Lal Sharma",
        "position": "Chief Minister of Rajasthan",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "Sanganer, Rajasthan",
        "start_date": "15 December 2023"
    },
    {
        "name": "M. K. Stalin",
        "position": "Chief Minister of Tamil Nadu",
        "party": "Dravida Munnetra Kazhagam (DMK)",
        "constituency": "Kolathur, Tamil Nadu",
        "start_date": "7 May 2021"
    },
    {
        "name": "Yogi Adityanath",
        "position": "Chief Minister of Uttar Pradesh",
        "party": "Bharatiya Janata Party (BJP)",
        "constituency": "N/A",
        "start_date": "19 March 2017"
    },
    {
        "name": "Mamata Banerjee",
        "position": "Chief Minister of West Bengal",
        "party": "All India Trinamool Congress (TMC)",
        "constituency": "Bhabanipur, West Bengal",
        "start_date": "20 May 2011"
    },
    {
        "name": "Akhilesh Yadav",
        "position": "Leader of the Opposition (Lok Sabha)",
        "party": "Samajwadi Party (SP)",
        "constituency": "Kannauj, Uttar Pradesh",
        "start_date": "N/A"
    },
    {
        "name": "Rahul Gandhi",
        "position": "Member of Parliament (Lok Sabha)",
        "party": "Indian National Congress (INC)",
        "constituency": "Rae Bareli, Uttar Pradesh",
        "start_date": "N/A"
    }
]

#Lists
#1. Get names: Make a new list that holds only the names of all the politicians.
names_list = []

for politician in politician_dataset:
    names_list.append(politician["name"])

print(names_list)

#2. Filter by party: Write a function that finds all politicians from a given party, like the "Bharatiya Janata Party (BJP)".
def filter_by_party(politician_dataset, party_name):
    return [politician for politician in politician_dataset if politician["party"] == party_name]

bjp_politicians = filter_by_party(politician_dataset, "Bharatiya Janata Party (BJP)")
for p in bjp_politicians:
    print(f"Name: {p['name']}, Position: {p['position']}")

#3. Unique parties: Find all the different political parties in the list and put them in a new list.
def find_unique_parties(politician_dataset):
    unique_parties = set()
    for politician in politician_dataset:
        unique_parties.add(politician["party"])
    return list(unique_parties)

all_unique_parties = find_unique_parties(politician_dataset)
print("All unique parties:", all_unique_parties)

#4. Count by party: Create a program that counts how many politicians are in each political party.
def count_politicians_by_party(dataset):
    party_counts = {}
    for politician in dataset:
        party = politician.get("party")
        if party:
            party_counts[party] = party_counts.get(party, 0) + 1
    return party_counts

party_counts = count_politicians_by_party(politician_dataset)

for party, count in party_counts.items():
    print(f"{party}: {count}")

#5. Find longest-serving: Find the politician who has been in office the longest. Be careful with entries that have missing or incomplete start dates.
import datetime

def find_longest_serving_politician(dataset):
    longest_tenure_politician = None
    longest_tenure_days = -1

    today = datetime.date.today()

    for politician in dataset:
        start_date_str = politician.get("start_date")

        if not start_date_str or start_date_str == "N/A":
            continue

        try:
            start_date = datetime.datetime.strptime(start_date_str, "%d %B %Y").date()
            tenure_days = (today - start_date).days

            if tenure_days > longest_tenure_days:
                longest_tenure_days = tenure_days
                longest_tenure_politician = politician

        except ValueError:
            print(f"Warning: Could not parse date for {politician.get('name')}: {start_date_str}")
            continue

    return longest_tenure_politician

longest_serving = find_longest_serving_politician(politician_dataset)

if longest_serving:
    print("The longest-serving politician is:")
    print(f"Name: {longest_serving.get('name')}")
    print(f"Position: {longest_serving.get('position')}")
    print(f"Party: {longest_serving.get('party')}")
    print(f"Start Date: {longest_serving.get('start_date')}")
else:
    print("Could not determine the longest-serving politician from the provided data.")

#Tuples
#1. Create name-party tuples: Make a list where each item is a pair (a tuple) containing a politician's name and their party.
name_party_tuples = [(p["name"], p["party"]) for p in politician_dataset]

for item in name_party_tuples:
    print(item)

#2. Basic named tuple: Create a special type of tuple for a politician that has fields for name, position, and party.
list_of_tuples = [(p["name"], p["position"], p["party"]) for p in politician_dataset]
tuple_of_tuples = tuple(list_of_tuples)

for item in tuple_of_tuples:
    print(item)

#3. Save politician details: Store the name, position, and voting area (constituency) for a politician like 'Bhagwant Mann' in an unchanging tuple. Explain why a tuple is a good choice for this.
def get_politician_tuple(name, dataset):
    for politician in dataset:
        if politician["name"] == name:
            return (politician["name"], politician["position"], politician["constituency"])
    return None

bhagwant_mann_details = get_politician_tuple("Bhagwant Mann", politician_dataset)

if bhagwant_mann_details:
    print("Bhagwant Mann's details as a tuple:")
    print(bhagwant_mann_details)
    print("\nWhy a tuple is a good choice for this data:")
    print(
        "1. Immutability: The data (name, position, voting area) is fixed and should not be changed after creation. A tuple's immutability ensures this data integrity.")
    print(
        "2. Performance: Tuples are slightly more memory-efficient and can be faster to process than lists, especially when dealing with fixed records.")
    print(
        "3. Readability and Intent: Using a tuple signals to other developers that this is a fixed, ordered collection of related items, improving code clarity.")
else:
    print("Politician 'Bhagwant Mann' not found in the dataset.")

#4. Sort by party: Create a sorted list of pairs (tuples), with the party name first and the politician's name second.
party_name_list = sorted([(p["party"], p["name"]) for p in politician_dataset])

sorted_politicians_tuple = tuple(party_name_list)

print(sorted_politicians_tuple)

#5. Check for duplicate entries: Write a program that looks for duplicate politicians by checking if they have the same name and voting area (constituency). Your program should list any duplicate entries it finds.
def find_duplicate_politicians(data):
    seen = set()
    duplicates = []
    for politician in data:
        identifier = (politician["name"], politician["constituency"])
        if identifier in seen:
            duplicates.append(politician)
        else:
            seen.add(identifier)
    return duplicates

duplicate_entries = find_duplicate_politicians(politician_dataset)

if duplicate_entries:
    print("Found duplicate entries:")
    for entry in duplicate_entries:
        print(f"  - Name: {entry['name']}, Constituency: {entry['constituency']}")
else:
    print("No duplicate entries found based on name and constituency.")

#Dictionary
#1. Find by name: Write a function that searches for a politician by name and gives you their full information.
def find_politician_by_name(dataset, name):
    for politician in dataset:
        if politician["name"].lower() == name.lower():
            return politician
    return None

politician_info = find_politician_by_name(politician_dataset, "Amit Shah")

if politician_info:
    print(politician_info)
else:
    print("Politician not found.")

#2. Update information: Change the start_date for a politician like 'Rajnath Singh', whose date is currently "N/A".
def update_politician_info(dataset, name, key, new_value):
    for politician in dataset:
        if politician["name"].lower() == name.lower():
            politician[key] = new_value
            return True
    return False

update_politician_info(politician_dataset, "Rajnath Singh", "start_date", "1 June 2019")

rajnath_singh_info = None
for politician in politician_dataset:
    if politician["name"] == "Rajnath Singh":
        rajnath_singh_info = politician
        break

if rajnath_singh_info:
    print("Updated information for Rajnath Singh:")
    print(rajnath_singh_info)
else:
    print("Politician not found.")

#3. Group by party: Organize all the politicians into a single dictionary. The keys should be the political parties, and the values should be a list of all the politicians in that party.
from collections import defaultdict

def group_politicians_by_party(dataset):
    grouped_by_party = defaultdict(list)
    for politician in dataset:
        party = politician["party"]
        grouped_by_party[party].append(politician)
    return dict(grouped_by_party)


politicians_by_party = group_politicians_by_party(politician_dataset)

import pprint

pprint.pprint(politicians_by_party)

#4. Group by state: Create a dictionary that groups politicians by their state, which is found in their constituency field.
from collections import defaultdict

def group_politicians_by_state(dataset):
    grouped_by_state = defaultdict(list)
    for politician in dataset:
        constituency = politician.get("constituency")

        if constituency == "N/A" or not constituency:
            state = "N/A"
        else:
            state = constituency.split(',')[-1].strip()
        grouped_by_state[state].append(politician)

    return dict(grouped_by_state)

politicians_by_state = group_politicians_by_state(politician_dataset)

import pprint
pprint.pprint(politicians_by_state)
